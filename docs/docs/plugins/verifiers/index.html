<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-plugins/verifiers" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.7.0">
<title data-rh="true">Verifier plugin | Otoroshi Biscuit Studio</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://cloud-apim.github.io/otoroshi-biscuit-studio/img/otoroshi-biscuit-studio-logo.png"><meta data-rh="true" name="twitter:image" content="https://cloud-apim.github.io/otoroshi-biscuit-studio/img/otoroshi-biscuit-studio-logo.png"><meta data-rh="true" property="og:url" content="https://cloud-apim.github.io/otoroshi-biscuit-studio/docs/plugins/verifiers"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Verifier plugin | Otoroshi Biscuit Studio"><meta data-rh="true" name="description" content="Integrate verifiers plugins into your Otoroshi routes to check the validity of Biscuit tokens and add your own rules to verify those tokens."><meta data-rh="true" property="og:description" content="Integrate verifiers plugins into your Otoroshi routes to check the validity of Biscuit tokens and add your own rules to verify those tokens."><link data-rh="true" rel="icon" href="/otoroshi-biscuit-studio/img/otoroshi-biscuit-studio-logo-no-bg-no-text.png"><link data-rh="true" rel="canonical" href="https://cloud-apim.github.io/otoroshi-biscuit-studio/docs/plugins/verifiers"><link data-rh="true" rel="alternate" href="https://cloud-apim.github.io/otoroshi-biscuit-studio/docs/plugins/verifiers" hreflang="en"><link data-rh="true" rel="alternate" href="https://cloud-apim.github.io/otoroshi-biscuit-studio/docs/plugins/verifiers" hreflang="x-default"><link rel="stylesheet" href="/otoroshi-biscuit-studio/assets/css/styles.e654c165.css">
<script src="/otoroshi-biscuit-studio/assets/js/runtime~main.eadbc206.js" defer="defer"></script>
<script src="/otoroshi-biscuit-studio/assets/js/main.d9c6e81f.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/otoroshi-biscuit-studio/"><div class="navbar__logo"><img src="/otoroshi-biscuit-studio/img/otoroshi-biscuit-studio-logo-no-bg-no-text.png" alt="otoroshi-biscuit-studio Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/otoroshi-biscuit-studio/img/otoroshi-biscuit-studio-logo-no-bg-no-text.png" alt="otoroshi-biscuit-studio Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Otoroshi Biscuit Studio</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/otoroshi-biscuit-studio/docs/overview">Documentation</a><a class="navbar__item navbar__link" href="/otoroshi-biscuit-studio/docs/api">API Reference</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/cloud-apim/otoroshi-biscuit-studio" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://www.cloud-apim.com" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Cloud APIM<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://blog.cloud-apim.com" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Cloud APIM Blog<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/otoroshi-biscuit-studio/docs/overview">Overview</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/otoroshi-biscuit-studio/docs/introduction">Introduction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/otoroshi-biscuit-studio/docs/install">Installation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/otoroshi-biscuit-studio/docs/configuration">Environment variables</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/otoroshi-biscuit-studio/docs/category/entities">Entities</a><button aria-label="Expand sidebar category &#x27;Entities&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/otoroshi-biscuit-studio/docs/category/plugins">Plugins</a><button aria-label="Collapse sidebar category &#x27;Plugins&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/otoroshi-biscuit-studio/docs/plugins/verifiers">Verifier plugin</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/otoroshi-biscuit-studio/docs/plugins/attenuators">Attenuator plugin</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/otoroshi-biscuit-studio/docs/plugins/clientcredentials">Client Credentials plugin</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/otoroshi-biscuit-studio/docs/plugins/keypairsexposition">Exposing Biscuit Public Keys</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/otoroshi-biscuit-studio/docs/plugins/biscuit-user-extractor">Biscuit User Extractor plugin</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/otoroshi-biscuit-studio/docs/plugins/user-to-biscuit">User to Biscuit Token Plugin</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/otoroshi-biscuit-studio/docs/plugins/apikeybridge">Biscuit to ApiKey Bridge Plugin</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/otoroshi-biscuit-studio/docs/plugins/remotetokenfetcher">Remote token fetcher</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/otoroshi-biscuit-studio/docs/api">API Documentation</a></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/otoroshi-biscuit-studio/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/otoroshi-biscuit-studio/docs/category/plugins"><span itemprop="name">Plugins</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Verifier plugin</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Verifier plugin</h1></header>
<p>Integrate verifiers plugins into your Otoroshi routes to check the validity of Biscuit tokens and add your own rules to verify those tokens.</p>
<p>This ensures that only authorized requests are processed, providing additional layers of security and control over your API traffic.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="example-request-before-using-a-biscuit-verifier"><strong>Example Request Before Using a Biscuit Verifier</strong><a href="#example-request-before-using-a-biscuit-verifier" class="hash-link" aria-label="Direct link to example-request-before-using-a-biscuit-verifier" title="Direct link to example-request-before-using-a-biscuit-verifier">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="original-request-token-in-header"><strong>Original Request (Token in Header)</strong><a href="#original-request-token-in-header" class="hash-link" aria-label="Direct link to original-request-token-in-header" title="Direct link to original-request-token-in-header">​</a></h4>
<div class="language-http codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-http codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">GET /api/resource HTTP/1.1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Host: example.com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Authorization: Biscuit BISCUIT_TOKEN...originalTokenData</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="using-a-biscuit-verifier"><strong>Using a Biscuit Verifier</strong><a href="#using-a-biscuit-verifier" class="hash-link" aria-label="Direct link to using-a-biscuit-verifier" title="Direct link to using-a-biscuit-verifier">​</a></h3>
<ol>
<li><strong>Extract Token</strong>: The <code>Authorization</code> header contains the Biscuit token.</li>
<li><strong>Create a Verifier</strong>: Instantiate a Biscuit verifier and attach specific constraints (e.g., check user roles, request path, or expiration).</li>
<li><strong>Validate the Token</strong>: Use the verifier to validate the token against the attached constraints. If valid, proceed; otherwise, deny the request.</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="step-1--create-the-otoroshi-route">Step 1 : Create the Otoroshi Route<a href="#step-1--create-the-otoroshi-route" class="hash-link" aria-label="Direct link to Step 1 : Create the Otoroshi Route" title="Direct link to Step 1 : Create the Otoroshi Route">​</a></h3>
<p><img decoding="async" loading="lazy" src="/otoroshi-biscuit-studio/assets/images/biscuit-verifier-route-creation-263f0559c189c136f41aeecca5b9a12e.png" width="2824" height="1568" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="step-2--select-the-biscuit-verifier-plugin">Step 2 : Select the Biscuit verifier plugin<a href="#step-2--select-the-biscuit-verifier-plugin" class="hash-link" aria-label="Direct link to Step 2 : Select the Biscuit verifier plugin" title="Direct link to Step 2 : Select the Biscuit verifier plugin">​</a></h3>
<p><img decoding="async" loading="lazy" src="/otoroshi-biscuit-studio/assets/images/biscuit-verifier-route-add-plugin-7d568a1b6af13e10b0dc8b1c88ecd198.png" width="2824" height="1568" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="step-3--add-the-plugin-to-your-route">Step 3 : Add the plugin to your Route<a href="#step-3--add-the-plugin-to-your-route" class="hash-link" aria-label="Direct link to Step 3 : Add the plugin to your Route" title="Direct link to Step 3 : Add the plugin to your Route">​</a></h3>
<p><img decoding="async" loading="lazy" src="/otoroshi-biscuit-studio/assets/images/biscuit-verifier-route-add-to-flow-ccd64f81d671dab87c4cdd44e497c419.png" width="2824" height="1568" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="step-4--configure-the-plugin">Step 4 : Configure the Plugin<a href="#step-4--configure-the-plugin" class="hash-link" aria-label="Direct link to Step 4 : Configure the Plugin" title="Direct link to Step 4 : Configure the Plugin">​</a></h3>
<p><img decoding="async" loading="lazy" src="/otoroshi-biscuit-studio/assets/images/biscuit-verifier-route-setup-flow-a630526da69bbc25516fccf3575bba21.png" width="2824" height="1568" class="img_ev3q"></p>
<ul>
<li>
<p>Select a Biscuit Verifier entity you would like to use.</p>
</li>
<li>
<p>Finally, choose the name of the extractor (Example : could be <code>Authorization</code> for headers)</p>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="example--verifier-plugin-configuration">Example : Verifier Plugin configuration<a href="#example--verifier-plugin-configuration" class="hash-link" aria-label="Direct link to Example : Verifier Plugin configuration" title="Direct link to Example : Verifier Plugin configuration">​</a></h2>
<p>Here is a demo configuration :</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string-property property" style="color:#36acaa">&quot;verifier_refs&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string-property property" style="color:#36acaa">&quot;enforce&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="fields-explanation-">Fields explanation :<a href="#fields-explanation-" class="hash-link" aria-label="Direct link to Fields explanation :" title="Direct link to Fields explanation :">​</a></h3>
<table><thead><tr><th>Item</th><th>Type</th><th>Default value</th><th>Explanation</th></tr></thead><tbody><tr><td><code>verifier_refs</code></td><td>Array</td><td><code>[]</code></td><td>A list a of verifier entities</td></tr><tr><td><code>enforce</code></td><td>Boolean</td><td><code>true</code></td><td>If enabled and neither verifier could verify rightly the token, then should return forbidden.</td></tr></tbody></table>
<h1>Biscuit Verifier Plugin Default Facts</h1>
<p>In the context of a Biscuit Verifier, the following data points are typically used to verify requests, ensuring proper authorization and access control. The facts are provided by the authorizer and give insight into the request, the user, and the environment to assess the legitimacy of the request.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="common-default-facts">Common Default Facts<a href="#common-default-facts" class="hash-link" aria-label="Direct link to Common Default Facts" title="Direct link to Common Default Facts">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="1-resource-information">1. Resource Information<a href="#1-resource-information" class="hash-link" aria-label="Direct link to 1. Resource Information" title="Direct link to 1. Resource Information">​</a></h3>
<ul>
<li><strong>Purpose</strong>: Identifies the resource being accessed, such as a service, domain, or a specific API endpoint. This helps the verifier determine whether the request is targeting an authorized resource.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="2-request-metadata">2. Request Metadata<a href="#2-request-metadata" class="hash-link" aria-label="Direct link to 2. Request Metadata" title="Direct link to 2. Request Metadata">​</a></h3>
<ul>
<li><strong>Purpose</strong>: Contains details like the HTTP method, requested path, and the domain name from which the request originated. This is crucial for ensuring the right HTTP request is processed according to rules.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="3-user-context">3. User Context<a href="#3-user-context" class="hash-link" aria-label="Direct link to 3. User Context" title="Direct link to 3. User Context">​</a></h3>
<ul>
<li><strong>Purpose</strong>: Identifies the user or entity making the request, including details like their assigned permissions. It helps verify if the requester has the proper authorization to access the requested resource.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="4-temporal-information">4. Temporal Information<a href="#4-temporal-information" class="hash-link" aria-label="Direct link to 4. Temporal Information" title="Direct link to 4. Temporal Information">​</a></h3>
<ul>
<li><strong>Purpose</strong>: Captures timestamps related to the request. This is helpful for enforcing time-based access control policies, ensuring that requests are within a valid timeframe.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="5-route-identifiers">5. Route Identifiers<a href="#5-route-identifiers" class="hash-link" aria-label="Direct link to 5. Route Identifiers" title="Direct link to 5. Route Identifiers">​</a></h3>
<ul>
<li><strong>Purpose</strong>: Associates requests with unique route descriptors for more granular access control. This enables detailed access control based on the specific path or service the request is targeting.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="default-facts-table">Default Facts Table<a href="#default-facts-table" class="hash-link" aria-label="Direct link to Default Facts Table" title="Direct link to Default Facts Table">​</a></h2>
<table><thead><tr><th>Fact Name</th><th>Definition</th><th>Example</th></tr></thead><tbody><tr><td><code>hostname</code></td><td>The hostname of the server processing the request.</td><td><code>hostname(&quot;server-123.example.com&quot;)</code></td></tr><tr><td><code>req_path</code></td><td>The path being requested.</td><td><code>req_path(&quot;/documents&quot;)</code></td></tr><tr><td><code>req_domain</code></td><td>The domain name of the requested service.</td><td><code>req_domain(&quot;api.example.com&quot;)</code></td></tr><tr><td><code>req_method</code></td><td>The HTTP method used in the request.</td><td><code>req_method(&quot;post&quot;)</code></td></tr><tr><td><code>route_id</code></td><td>The unique identifier of the route descriptor.</td><td><code>route_id(&quot;route_518e34e7a-e2cb-4687-952c-37a3d98b8001&quot;)</code></td></tr><tr><td><code>ip_address</code></td><td>The IP address of the requester.</td><td><code>ip_address(&quot;192.168.1.1&quot;)</code></td></tr><tr><td><code>user_name</code> (if present)</td><td>The authenticated username of the requester.</td><td><code>user_name(&quot;alice&quot;)</code></td></tr><tr><td><code>user_email</code> (if present)</td><td>The authenticated email of the requester.</td><td><code>user_email(&quot;alice@example.com&quot;)</code></td></tr><tr><td><code>user_tag</code> (if present)</td><td>The user&#x27;s associated tag for additional categorization.</td><td><code>user_tag(&quot;premium_user&quot;)</code></td></tr><tr><td><code>user_metadata</code> (if present)</td><td>Additional metadata associated with the user.</td><td><code>user_metadata({&quot;role&quot;: &quot;admin&quot;, &quot;department&quot;: &quot;HR&quot;})</code></td></tr><tr><td><code>apikey_client_id</code> (if present)</td><td>The unique identifier of the API key&#x27;s client.</td><td><code>apikey_client_id(&quot;client_1234&quot;)</code></td></tr><tr><td><code>apikey_client_name</code> (if present)</td><td>The name of the client associated with the API key.</td><td><code>apikey_client_name(&quot;ClientOne&quot;)</code></td></tr><tr><td><code>apikey_tag</code> (if present)</td><td>A tag associated with the API key for categorization.</td><td><code>apikey_tag(&quot;v1_api_key&quot;)</code></td></tr><tr><td><code>apikey_metadata</code> (if present)</td><td>Additional metadata associated with the API key.</td><td><code>apikey_metadata({&quot;scope&quot;: &quot;read&quot;, &quot;region&quot;: &quot;US&quot;})</code></td></tr><tr><td><code>req_headers</code></td><td>The HTTP headers sent with the request, including various key details like authorization tokens, user-agent, etc.</td><td><code>req_headers(&quot;custom-header&quot;, &quot;&lt;value&gt;&quot;)</code><br><code>req_headers(&quot;remote-address&quot;, &quot;192.168.1.1:56246&quot;)</code><br><code>req_headers(&quot;authorization&quot;, &quot;Bearer &lt;token&gt;&quot;)</code><br><code>req_headers(&quot;request-start-time&quot;, &quot;&lt;timestamp&gt;&quot;)</code><br><code>req_headers(&quot;accept-encoding&quot;, &quot;gzip, deflate&quot;)</code></td></tr></tbody></table>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="explanation-of-key-facts-for-biscuit-verifier">Explanation of Key Facts for Biscuit Verifier<a href="#explanation-of-key-facts-for-biscuit-verifier" class="hash-link" aria-label="Direct link to Explanation of Key Facts for Biscuit Verifier" title="Direct link to Explanation of Key Facts for Biscuit Verifier">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="hostname"><code>hostname</code><a href="#hostname" class="hash-link" aria-label="Direct link to hostname" title="Direct link to hostname">​</a></h3>
<ul>
<li><strong>Explanation</strong>: This represents the specific server handling the request. By using the hostname, the verifier can ensure the request is being processed by the correct server within the authorized infrastructure.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="req_path"><code>req_path</code><a href="#req_path" class="hash-link" aria-label="Direct link to req_path" title="Direct link to req_path">​</a></h3>
<ul>
<li><strong>Explanation</strong>: This is the path the request is targeting. It is essential to verify that the request is trying to access a valid and permitted path, based on the verifier&#x27;s rules.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="req_domain"><code>req_domain</code><a href="#req_domain" class="hash-link" aria-label="Direct link to req_domain" title="Direct link to req_domain">​</a></h3>
<ul>
<li><strong>Explanation</strong>: The domain helps verify if the request is targeting the right service. The verifier checks the domain to ensure the request is aligned with the expected API or service domain.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="req_method"><code>req_method</code><a href="#req_method" class="hash-link" aria-label="Direct link to req_method" title="Direct link to req_method">​</a></h3>
<ul>
<li><strong>Explanation</strong>: The HTTP method (GET, POST, PUT, DELETE, etc.) tells the verifier what kind of operation is being requested. Some methods may be restricted based on the user&#x27;s permissions or resource settings.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="route_id"><code>route_id</code><a href="#route_id" class="hash-link" aria-label="Direct link to route_id" title="Direct link to route_id">​</a></h3>
<ul>
<li><strong>Explanation</strong>: A unique identifier for the route that can be associated with specific access control rules. By using <code>route_id</code>, the verifier can enforce policies that are specific to a particular route or service.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="ip_address"><code>ip_address</code><a href="#ip_address" class="hash-link" aria-label="Direct link to ip_address" title="Direct link to ip_address">​</a></h3>
<ul>
<li><strong>Explanation</strong>: The IP address allows the verifier to track where the request is coming from. In some cases, geographical or network restrictions might be applied based on the IP.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="user_name-if-present"><code>user_name</code> (if present)<a href="#user_name-if-present" class="hash-link" aria-label="Direct link to user_name-if-present" title="Direct link to user_name-if-present">​</a></h3>
<ul>
<li><strong>Explanation</strong>: This is the authenticated username of the requester. It is used by the verifier to determine whether the user is authorized to perform the requested action based on their permissions.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="user_email-if-present"><code>user_email</code> (if present)<a href="#user_email-if-present" class="hash-link" aria-label="Direct link to user_email-if-present" title="Direct link to user_email-if-present">​</a></h3>
<ul>
<li><strong>Explanation</strong>: If the user’s email is present, it can help identify the user uniquely and enable further context about their authentication and permissions.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="user_tag-if-present"><code>user_tag</code> (if present)<a href="#user_tag-if-present" class="hash-link" aria-label="Direct link to user_tag-if-present" title="Direct link to user_tag-if-present">​</a></h3>
<ul>
<li><strong>Explanation</strong>: The user&#x27;s associated tag provides additional categorization of the user, which may be used for access control or other policies.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="user_metadata-if-present"><code>user_metadata</code> (if present)<a href="#user_metadata-if-present" class="hash-link" aria-label="Direct link to user_metadata-if-present" title="Direct link to user_metadata-if-present">​</a></h3>
<ul>
<li><strong>Explanation</strong>: Additional metadata tied to the user, offering further context such as roles, groups, or other important attributes.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="apikey_client_id-if-present"><code>apikey_client_id</code> (if present)<a href="#apikey_client_id-if-present" class="hash-link" aria-label="Direct link to apikey_client_id-if-present" title="Direct link to apikey_client_id-if-present">​</a></h3>
<ul>
<li><strong>Explanation</strong>: The client ID associated with the API key. It is important for verifying the specific client making the request.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="apikey_client_name-if-present"><code>apikey_client_name</code> (if present)<a href="#apikey_client_name-if-present" class="hash-link" aria-label="Direct link to apikey_client_name-if-present" title="Direct link to apikey_client_name-if-present">​</a></h3>
<ul>
<li><strong>Explanation</strong>: The name of the client associated with the API key, often used for easier identification and access control.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="apikey_tag-if-present"><code>apikey_tag</code> (if present)<a href="#apikey_tag-if-present" class="hash-link" aria-label="Direct link to apikey_tag-if-present" title="Direct link to apikey_tag-if-present">​</a></h3>
<ul>
<li><strong>Explanation</strong>: A tag tied to the API key, which might be used to distinguish between different versions or categories of API keys.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="apikey_metadata-if-present"><code>apikey_metadata</code> (if present)<a href="#apikey_metadata-if-present" class="hash-link" aria-label="Direct link to apikey_metadata-if-present" title="Direct link to apikey_metadata-if-present">​</a></h3>
<ul>
<li><strong>Explanation</strong>: Metadata related to the API key, providing extra details such as the scope of access or permissions granted.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="req_headers"><code>req_headers</code><a href="#req_headers" class="hash-link" aria-label="Direct link to req_headers" title="Direct link to req_headers">​</a></h3>
<ul>
<li><strong>Explanation</strong>: This contains various HTTP headers that can hold important context about the request. Key headers used in Biscuit Verifiers include:<!-- -->
<ul>
<li><strong>Authorization</strong>: Used for passing authorization tokens (like Biscuit tokens) to verify the user’s credentials and permissions.</li>
<li><strong>Remote-address</strong>: Denotes the IP address and port of the requester.</li>
<li><strong>Request Start Time</strong>: Can be used for validating time-based conditions in access control.</li>
<li><strong>Accept-Encoding</strong>: Specifies what encoding methods the client supports, which might impact how the server processes the request.</li>
</ul>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="demo">Demo<a href="#demo" class="hash-link" aria-label="Direct link to Demo" title="Direct link to Demo">​</a></h2>
<p>We need to create a route with our <code>Biscuit Verifier Plugin</code></p>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">curl</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-X</span><span class="token plain"> POST </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token parameter variable" style="color:#36acaa">-H</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;Content-Type: application/json&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token parameter variable" style="color:#36acaa">-H</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;Otoroshi-Client-Id: admin-api-apikey-id&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token parameter variable" style="color:#36acaa">-H</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;Otoroshi-Client-Secret: admin-api-apikey-secret&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;http://otoroshi-api.oto.tools:8080/apis/proxy.otoroshi.io/v1/routes&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token parameter variable" style="color:#36acaa">-d</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;{</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">  &quot;_loc&quot; : {</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    &quot;tenant&quot; : &quot;default&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    &quot;teams&quot; : [ &quot;default&quot; ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">  },</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">  &quot;id&quot; : &quot;4874704c-56a2-4460-9a21-ff8055a19c75&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">  &quot;name&quot; : &quot;test route&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">  &quot;description&quot; : &quot;test route&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">  &quot;tags&quot; : [ ],</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">  &quot;metadata&quot; : { },</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">  &quot;enabled&quot; : true,</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">  &quot;groups&quot; : [ &quot;default&quot; ],</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">  &quot;bound_listeners&quot; : [ ],</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">  &quot;frontend&quot; : {</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    &quot;domains&quot; : [ &quot;biscuit-verifier.oto.tools&quot; ],</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    &quot;strip_path&quot; : true,</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    &quot;exact&quot; : false,</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    &quot;headers&quot; : { },</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    &quot;query&quot; : { },</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    &quot;methods&quot; : [ ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">  },</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">  &quot;backend&quot; : {</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    &quot;targets&quot; : [ {</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">      &quot;id&quot; : &quot;www.otoroshi.io&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">      &quot;hostname&quot; : &quot;www.otoroshi.io&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">      &quot;port&quot; : 443,</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">      &quot;tls&quot; : true,</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">      &quot;weight&quot; : 1,</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">      &quot;predicate&quot; : {</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">        &quot;type&quot; : &quot;AlwaysMatch&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">      },</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">      &quot;protocol&quot; : &quot;HTTP/1.1&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">      &quot;ip_address&quot; : null,</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">      &quot;tls_config&quot; : {</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">        &quot;certs&quot; : [ ],</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">        &quot;trusted_certs&quot; : [ ],</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">        &quot;enabled&quot; : false,</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">        &quot;loose&quot; : false,</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">        &quot;trust_all&quot; : false</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">      }</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    } ],</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    &quot;root&quot; : &quot;/&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    &quot;rewrite&quot; : false,</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    &quot;load_balancing&quot; : {</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">      &quot;type&quot; : &quot;RoundRobin&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">  },</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">  &quot;backend_ref&quot; : null,</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">  &quot;plugins&quot; : [ </span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">      {</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">      &quot;enabled&quot; : true,</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">      &quot;debug&quot; : false,</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">      &quot;plugin&quot; : &quot;cp:otoroshi.next.plugins.EchoBackend&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">      &quot;include&quot; : [ ],</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">      &quot;exclude&quot; : [ ],</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">      &quot;config&quot; : {</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">        &quot;limit&quot;: 524288</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">      },</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">      &quot;bound_listeners&quot; : [ ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    },</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">      &quot;enabled&quot; : true,</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">      &quot;debug&quot; : false,</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">      &quot;plugin&quot; : &quot;cp:otoroshi_plugins.com.cloud.apim.otoroshi.extensions.biscuit.plugins.BiscuitTokenValidator&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">      &quot;include&quot; : [ ],</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">      &quot;exclude&quot; : [ ],</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">      &quot;config&quot; : {</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">        &quot;verifier_refs&quot; : [</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">          &quot;biscuit_verifier_6f5f20a5-2c65-4860-8ad1-7b6495ee03bf&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">        ],</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">        &quot;enforce&quot;: true</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">      },</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">      &quot;bound_listeners&quot; : [ ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    } </span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">  ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">}&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Now we can call the route with our token in <code>Authorization</code> header.</p>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">curl</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-X</span><span class="token plain"> POST </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token parameter variable" style="color:#36acaa">-H</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;Content-Type: application/json&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token parameter variable" style="color:#36acaa">-H</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;Authorization: Biscuit: Eo0BCiMKBDEyMzQYAyIJCgcIChIDGIAIMg4KDAoCCBsSBggDEgIYABIkCAASIPCKFpXk1RhZiJoXZ0BHvsic65rH5MDSWZJt-8Rn1_XBGkDGK2CcUBcIdt7p3XmDCAEvYrFpB8w6nVPYz9vYFLUQ8M1wTSNaoP7M1UdD5S6AkA0ZJAaVkWsUHdcOgwNpiPwMIiIKIMHFnoE_nPPkAxIDCZ102kwX3z3SoXHp2xQCKik_38Fd&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;http://biscuit-verifier.oto.tools:8080&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The request should pass successfully.</p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/otoroshi-biscuit-studio/docs/category/plugins"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Plugins</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/otoroshi-biscuit-studio/docs/plugins/attenuators"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Attenuator plugin</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#example-request-before-using-a-biscuit-verifier" class="table-of-contents__link toc-highlight"><strong>Example Request Before Using a Biscuit Verifier</strong></a></li><li><a href="#using-a-biscuit-verifier" class="table-of-contents__link toc-highlight"><strong>Using a Biscuit Verifier</strong></a></li><li><a href="#step-1--create-the-otoroshi-route" class="table-of-contents__link toc-highlight">Step 1 : Create the Otoroshi Route</a></li><li><a href="#step-2--select-the-biscuit-verifier-plugin" class="table-of-contents__link toc-highlight">Step 2 : Select the Biscuit verifier plugin</a></li><li><a href="#step-3--add-the-plugin-to-your-route" class="table-of-contents__link toc-highlight">Step 3 : Add the plugin to your Route</a></li><li><a href="#step-4--configure-the-plugin" class="table-of-contents__link toc-highlight">Step 4 : Configure the Plugin</a></li><li><a href="#example--verifier-plugin-configuration" class="table-of-contents__link toc-highlight">Example : Verifier Plugin configuration</a><ul><li><a href="#fields-explanation-" class="table-of-contents__link toc-highlight">Fields explanation :</a></li></ul></li><li><a href="#common-default-facts" class="table-of-contents__link toc-highlight">Common Default Facts</a><ul><li><a href="#1-resource-information" class="table-of-contents__link toc-highlight">1. Resource Information</a></li><li><a href="#2-request-metadata" class="table-of-contents__link toc-highlight">2. Request Metadata</a></li><li><a href="#3-user-context" class="table-of-contents__link toc-highlight">3. User Context</a></li><li><a href="#4-temporal-information" class="table-of-contents__link toc-highlight">4. Temporal Information</a></li><li><a href="#5-route-identifiers" class="table-of-contents__link toc-highlight">5. Route Identifiers</a></li></ul></li><li><a href="#default-facts-table" class="table-of-contents__link toc-highlight">Default Facts Table</a></li><li><a href="#explanation-of-key-facts-for-biscuit-verifier" class="table-of-contents__link toc-highlight">Explanation of Key Facts for Biscuit Verifier</a><ul><li><a href="#hostname" class="table-of-contents__link toc-highlight"><code>hostname</code></a></li><li><a href="#req_path" class="table-of-contents__link toc-highlight"><code>req_path</code></a></li><li><a href="#req_domain" class="table-of-contents__link toc-highlight"><code>req_domain</code></a></li><li><a href="#req_method" class="table-of-contents__link toc-highlight"><code>req_method</code></a></li><li><a href="#route_id" class="table-of-contents__link toc-highlight"><code>route_id</code></a></li><li><a href="#ip_address" class="table-of-contents__link toc-highlight"><code>ip_address</code></a></li><li><a href="#user_name-if-present" class="table-of-contents__link toc-highlight"><code>user_name</code> (if present)</a></li><li><a href="#user_email-if-present" class="table-of-contents__link toc-highlight"><code>user_email</code> (if present)</a></li><li><a href="#user_tag-if-present" class="table-of-contents__link toc-highlight"><code>user_tag</code> (if present)</a></li><li><a href="#user_metadata-if-present" class="table-of-contents__link toc-highlight"><code>user_metadata</code> (if present)</a></li><li><a href="#apikey_client_id-if-present" class="table-of-contents__link toc-highlight"><code>apikey_client_id</code> (if present)</a></li><li><a href="#apikey_client_name-if-present" class="table-of-contents__link toc-highlight"><code>apikey_client_name</code> (if present)</a></li><li><a href="#apikey_tag-if-present" class="table-of-contents__link toc-highlight"><code>apikey_tag</code> (if present)</a></li><li><a href="#apikey_metadata-if-present" class="table-of-contents__link toc-highlight"><code>apikey_metadata</code> (if present)</a></li><li><a href="#req_headers" class="table-of-contents__link toc-highlight"><code>req_headers</code></a></li></ul></li><li><a href="#demo" class="table-of-contents__link toc-highlight">Demo</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/otoroshi-biscuit-studio/docs/overview">Documentation</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://discord.cloud-apim.com" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/cloudapim" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.youtube.com/@CloudAPIM" target="_blank" rel="noopener noreferrer" class="footer__link-item">Youtube<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://www.cloud-apim.com" target="_blank" rel="noopener noreferrer" class="footer__link-item">Cloud APIM<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://blog.cloud-apim.com" target="_blank" rel="noopener noreferrer" class="footer__link-item">Blog<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/cloud-apim/otoroshi-biscuit-studio" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2026 Cloud APIM Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>